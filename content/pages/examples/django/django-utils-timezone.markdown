title: django.utils.timezone Examples
category: page
slug: django-utils-timezone-examples
sortorder: 50020
toc: False
sidebartitle: django.utils.timezone
meta: Python code examples for timezone-related classes and functions provided by the Django codebase. 


# django.utils.timezone Examples
[timezone.py](https://github.com/django/django/blob/master/django/utils/timezone.py)
is a source file within the [Django](/django.html) project that contains
date and time-related helper classes and functions that are useful when 
building web applications.


## Example 1 from django-cms
[django-cms](https://github.com/divio/django-cms)
([project website](https://www.django-cms.org/en/)) is a Python-based
content management system (CMS) [library](https://pypi.org/project/django-cms/) 
for use with Django web apps that is open sourced under the 
[BSD 3-Clause "New" License](https://github.com/divio/django-cms/blob/develop/LICENSE).

[**django-cms/cms/models/query.py**](https://github.com/divio/django-cms/blob/develop/cms/models/query.py)

```python
# -*- coding: utf-8 -*-
from django.db.models import Q
~~from django.utils import timezone

from treebeard.mp_tree import MP_NodeQuerySet

from cms.publisher.query import PublisherQuerySet
from cms.exceptions import NoHomeFound


class PageQuerySet(PublisherQuerySet):

    def on_site(self, site=None):
        from cms.utils import get_current_site

        if site is None:
            site = get_current_site()
        return self.filter(node__site=site)

    def published(self, site=None, language=None):
~~        now = timezone.now()
        if language:
~~            pub = self.on_site(site).filter(
~~                Q(publication_date__lte=now) | \
~~                Q(publication_date__isnull=True),
~~                Q(publication_end_date__gt=now) | \
~~                Q(publication_end_date__isnull=True),
~~                title_set__published=True, title_set__language=language,
            )
        else:
~~            pub = self.on_site(site).filter(
~~                Q(publication_date__lte=now) | \
~~                Q(publication_date__isnull=True),
~~                Q(publication_end_date__gt=now) | \
~~                Q(publication_end_date__isnull=True),
~~                title_set__published=True,
            )
        return pub.exclude(title_set__publisher_state=4)
```


## Example 2 from django-smithy
[django-smithy](https://github.com/jamiecounsell/django-smithy) is
a [Django](/django.html) code library that allows users to send 
HTTP requests from the Django admin user interface. The code for
the project is open source under the 
[MIT license](https://github.com/jamiecounsell/django-smithy/blob/master/LICENSE).

[**django-smithy/smithy/migrations/0001_initial.py**](https://github.com/jamiecounsell/django-smithy/blob/master/smithy/migrations/0001_initial.py)

```python
# Generated by Django 2.1.5 on 2019-03-16 20:32

from django.db import migrations, models
import django.db.models.deletion
~~import django.utils.timezone
import model_utils.fields


class Migration(migrations.Migration):

    initial = True

    dependencies = [
    ]

    operations = [
        migrations.CreateModel(
            name='Cookie',
            fields=[
                ('id', models.AutoField(auto_created=True, 
                                        primary_key=True, serialize=False, 
                                        verbose_name='ID')),
~~                ('created', model_utils.fields.AutoCreatedField(\
~~                   default=django.utils.timezone.now, editable=False, 
~~                    verbose_name='created')),
~~                ('modified', model_utils.fields.AutoLastModifiedField(\
~~                   default=django.utils.timezone.now, editable=False, 
~~                   verbose_name='modified')),
                ('name', models.CharField(max_length=200)),
                ('value', models.TextField()),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='Header',
            fields=[
                ('id', models.AutoField(auto_created=True, 
                                        primary_key=True, 
                                        serialize=False, 
                                        verbose_name='ID')),
~~                ('created', model_utils.fields.AutoCreatedField(\
~~                 default=django.utils.timezone.now, editable=False, 
~~                 verbose_name='created')),
~~                ('modified', model_utils.fields.AutoLastModifiedField(\
~~                 default=django.utils.timezone.now, editable=False, 
~~                 verbose_name='modified')),
                ('name', models.CharField(max_length=200)),
                ('value', models.TextField()),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='QueryParameter',
            fields=[
                ('id', models.AutoField(auto_created=True, 
                                        primary_key=True, 
                                        serialize=False, 
                                        verbose_name='ID')),
~~                ('created', model_utils.fields.AutoCreatedField(\
~~                 default=django.utils.timezone.now, editable=False, 
~~                 verbose_name='created')),
~~                ('modified', model_utils.fields.AutoLastModifiedField(\
~~                 default=django.utils.timezone.now, editable=False, 
~~                 verbose_name='modified')),
                ('name', models.CharField(max_length=200)),
                ('value', models.TextField()),
            ],
            options={
                'abstract': False,
            },
        ),
```
